<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H27 Clash of Talents - Category-Wise Scoring</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: url('background-image.jpg') no-repeat center center fixed;
            background-size: cover;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #333;
            overflow: hidden;
        }
        .container {
            width: 90%;
            max-width: 1000px;
            padding: 40px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 5px 30px rgba(0, 0, 0, 0.4);
            text-align: center;
            position: relative;
        }
        .logo-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .logo-left, .logo-right {
            width: 100px;
            height: auto;
        }
        .header {
            font-size: 2.8em;
            font-weight: 700;
            color: #e74c3c;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .subtitle {
            font-size: 1.4em;
            color: #2c3e50;
            margin-bottom: 30px;
            line-height: 1.8;
            text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.1);
        }
        .table-container {
            margin-top: 40px;
            overflow-y: auto;
            border: 1px solid #ddd;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table th, table td {
            padding: 12px;
            text-align: center;
            border: 1px solid #ddd;
            white-space: nowrap;
        }
        table th {
            background-color: #f39c12;
            color: #ffffff;
            font-weight: 700;
            text-transform: uppercase;
            position: sticky;
            top: 0;
            z-index: 2;
        }
        table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        table tr.total-row {
            background-color: #f1c40f;
            font-weight: 700;
            position: sticky;
            bottom: 0;
            z-index: 1;
        }
        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        .nav-button {
            padding: 15px 25px;
            background-color: #e67e22;
            color: #ffffff;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
        }
        .nav-button:hover {
            background-color: #d35400;
            transform: translateY(-3px);
        }
        a {
            color: inherit;
            text-decoration: none;
        }
    </style>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="container">
        <div class="logo-container">
            <img src="logo-left.png" alt="Organizer Logo" class="logo-left">
            <img src="logo-right.png" alt="Event Logo" class="logo-right">
        </div>
        <div class="header">Category-Wise Scoring</div>
        <div class="subtitle">Detailed scoring of individual categories in the H27 Clash of Talents. This breakdown highlights the performance of participants across Speech, Singing, Acting, Dancing, and Instrument categories. Discover the stars of each category and celebrate their dedication and skill!</div>
        <div class="table-container">
            <table id="leaderboardTable">
                <!-- Table content will be inserted dynamically -->
            </table>
        </div>
        <div class="nav-buttons">
            <a href="team_scores.html" target="_blank"><button class="nav-button">Team Scores Leaderboard</button></a>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const apiKey = 'AIzaSyBBCuJHd2HJ679ZQWNe3jhQOk-61tXW-sE';  // Replace with your actual API key
            const sheetID = '1i3OGdne9Hok1th-I3UMtXgDGOcxGsXDRHZx9A6j_CYw'; // Replace with your actual sheet ID
            const range = 'CategorywiseScoring!A1:E26';  // Modify if your data range differs
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/${range}?key=${apiKey}`;

            fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    if (!data.values || data.values.length <= 1) {
                        console.error('No data found or only header row present.');
                        return;
                    }

                    const rows = data.values;
                    const table = document.getElementById('leaderboardTable');

                    // Create table header
                    const headerRow = document.createElement('tr');
                    rows[0].forEach(headerText => {
                        const th = document.createElement('th');
                        th.textContent = headerText;
                        headerRow.appendChild(th);
                    });
                    table.appendChild(headerRow);

                    // Create table rows (including total row)
                    rows.slice(1).forEach((row, index) => {
                        const tr = document.createElement('tr');
                        if (index === rows.length - 2) {
                            tr.classList.add('total-row');
                        }
                        row.forEach(cellText => {
                            const td = document.createElement('td');
                            td.textContent = cellText;
                            tr.appendChild(td);
                        });
                        table.appendChild(tr);
                    });
                })
                .catch(error => {
                    console.error('Error fetching the data:', error);
                });
        });
    </script>
</body>
</html>
